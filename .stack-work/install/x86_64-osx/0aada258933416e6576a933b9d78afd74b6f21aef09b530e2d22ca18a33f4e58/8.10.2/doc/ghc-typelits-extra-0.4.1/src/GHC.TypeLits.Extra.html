<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Copyright  :  (C) 2015-2016, University of Twente,
                  2017-2018, QBayLogic B.V.
License    :  BSD2 (see the file LICENSE)
Maintainer :  Christiaan Baaij &lt;christiaan.baaij@gmail.com&gt;

Additional type-level operations on 'GHC.TypeLits.Nat':

  * 'Max': type-level 'max'

  * 'Min': type-level 'min'

  * 'Div': type-level 'div'

  * 'Mod': type-level 'mod'

  * 'FLog': type-level equivalent of &lt;https://hackage.haskell.org/package/integer-gmp/docs/GHC-Integer-Logarithms.html#v:integerLogBase-35- integerLogBase#&gt;
    .i.e. the exact integer equivalent to &quot;@'floor' ('logBase' x y)@&quot;

  * 'CLog': type-level equivalent of /the ceiling of/ &lt;https://hackage.haskell.org/package/integer-gmp/docs/GHC-Integer-Logarithms.html#v:integerLogBase-35- integerLogBase#&gt;
    .i.e. the exact integer equivalent to &quot;@'ceiling' ('logBase' x y)@&quot;

  * 'Log': type-level equivalent of &lt;https://hackage.haskell.org/package/integer-gmp/docs/GHC-Integer-Logarithms.html#v:integerLogBase-35- integerLogBase#&gt;
     where the operation only reduces when &quot;@'floor' ('logBase' b x) ~ 'ceiling' ('logBase' b x)@&quot;

  * 'GCD': a type-level 'gcd'

  * 'LCM': a type-level 'lcm'

A custom solver for the above operations defined is defined in
&quot;GHC.TypeLits.Extra.Solver&quot; as a GHC type-checker plugin. To use the plugin,
add the

@
{\-\# OPTIONS_GHC -fplugin GHC.TypeLits.Extra.Solver \#-\}
@

pragma to the header of your file.
-}</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-pragma">{-# LANGUAGE CPP                   #-}</span><span>
</span><span id="line-42"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-43"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-44"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-45"></span><span class="hs-pragma">{-# LANGUAGE MagicHash             #-}</span><span>
</span><span id="line-46"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-47"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-48"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell       #-}</span><span>
</span><span id="line-49"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-50"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-51"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-52"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK show-extensions #-}</span><span>
</span><span id="line-55"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.TypeLits.Extra</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Type-level operations on `Nat`</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Ord</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="GHC.TypeLits.Extra.html#Max"><span class="hs-identifier">Max</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#Min"><span class="hs-identifier">Min</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Integral</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Div</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Mod</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#DivMod"><span class="hs-identifier">DivMod</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Variants</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#DivRU"><span class="hs-identifier">DivRU</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Logarithm</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#FLog"><span class="hs-identifier">FLog</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#CLog"><span class="hs-identifier">CLog</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Exact logarithm</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#Log"><span class="hs-identifier">Log</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- Numeric</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier">GCD</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier">LCM</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Type.Bool</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">If</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Base</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int#</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isTrue#</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(==#)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(+#)</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Integer.Logarithms</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">integerLogBase#</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_ghc(8,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Magic</span></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">noinline</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if MIN_VERSION_ghc(8,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">N</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Natural</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Prim</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">int2Word#</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Integer</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">smallInteger</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.TypeLits</span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">N</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(+)</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=)</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=?)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_ghc(8,4,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Div</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Mod</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits.KnownNat</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nameToSymbol</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_ghc(8,2,0)
</span><span class="annot"><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-identifier hs-type">intToNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-105"></span><span id="intToNumber"><span class="annot"><span class="annottext">intToNumber :: Int# -&gt; Natural
</span><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-identifier hs-var hs-var">intToNumber</span></a></span></span><span> </span><span id="local-6989586621679111762"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679111762"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GmpLimb# -&gt; Natural
</span><span class="hs-identifier hs-var">NatS#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; GmpLimb#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679111762"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">intToNumber</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span>
</span><span id="line-108"></span><span class="hs-identifier">intToNumber</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">smallInteger</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-pragma hs-type">intToNumber</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Type-level 'max'</span><span>
</span><span id="line-113"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Max"><span class="annot"><a href="GHC.TypeLits.Extra.html#Max"><span class="hs-identifier hs-var">Max</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111761"><span class="annot"><a href="#local-6989586621679111761"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111760"><span class="annot"><a href="#local-6989586621679111760"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="Max"><span class="annot"><a href="GHC.TypeLits.Extra.html#Max"><span class="hs-identifier hs-var">Max</span></a></span></span><span> </span><span id="local-6989586621679111759"><span class="annot"><a href="#local-6989586621679111759"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679111759"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111759"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span id="Max"><span class="annot"><a href="GHC.TypeLits.Extra.html#Max"><span class="hs-identifier hs-var">Max</span></a></span></span><span> </span><span id="local-6989586621679111758"><span class="annot"><a href="#local-6989586621679111758"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679111757"><span class="annot"><a href="#local-6989586621679111757"><span class="hs-identifier hs-type hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">If</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679111758"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679111757"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111757"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111758"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679111755"><span id="local-6989586621679111756"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111756"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111755"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Max</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111756"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111755"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679111752"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.Max&quot;
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.Max&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111756"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111755"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Type-level 'min'</span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Min"><span class="annot"><a href="GHC.TypeLits.Extra.html#Min"><span class="hs-identifier hs-var">Min</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111746"><span class="annot"><a href="#local-6989586621679111746"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111745"><span class="annot"><a href="#local-6989586621679111745"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="Min"><span class="annot"><a href="GHC.TypeLits.Extra.html#Min"><span class="hs-identifier hs-var">Min</span></a></span></span><span> </span><span id="local-6989586621679111744"><span class="annot"><a href="#local-6989586621679111744"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679111744"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111744"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span id="Min"><span class="annot"><a href="GHC.TypeLits.Extra.html#Min"><span class="hs-identifier hs-var">Min</span></a></span></span><span> </span><span id="local-6989586621679111743"><span class="annot"><a href="#local-6989586621679111743"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679111742"><span class="annot"><a href="#local-6989586621679111742"><span class="hs-identifier hs-type hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">If</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679111743"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=?</span></span><span> </span><span class="annot"><a href="#local-6989586621679111742"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111743"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111742"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679111740"><span id="local-6989586621679111741"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111741"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111740"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Min</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111741"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111740"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679111738"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.Min&quot;
</span><a href="#local-6989586621679111738"><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.Min&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111741"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111740"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span class="hs-cpp">

#if !MIN_VERSION_ghc(8,4,0)
</span><span class="hs-comment">-- | Type-level 'div'</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-133"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span class="hs-identifier">Div</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-identifier">Div</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">KnownNat</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">KnownNat</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">KnownNat2</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Div</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-identifier">natSing2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SNatKn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">quot</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N.natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N.natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | A variant of 'Div' that rounds up instead of down</span><span>
</span><span id="line-141"></span><span class="hs-keyword">type</span><span> </span><span id="DivRU"><span class="annot"><a href="GHC.TypeLits.Extra.html#DivRU"><span class="hs-identifier hs-var">DivRU</span></a></span></span><span> </span><span id="local-6989586621679111736"><span class="annot"><a href="#local-6989586621679111736"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679111735"><span class="annot"><a href="#local-6989586621679111735"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Div</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679111736"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679111735"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111735"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-cpp">

#if !MIN_VERSION_ghc(8,4,0)
</span><span class="hs-comment">-- | Type-level 'mod'</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-148"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span class="hs-identifier">Mod</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Nat</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-identifier">Mod</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">KnownNat</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">KnownNat</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">KnownNat2</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Mod</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-identifier">natSing2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SNatKn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N.natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">N.natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Type-level `divMod`</span><span>
</span><span id="line-156"></span><span class="hs-keyword">type</span><span> </span><span id="DivMod"><span class="annot"><a href="GHC.TypeLits.Extra.html#DivMod"><span class="hs-identifier hs-var">DivMod</span></a></span></span><span> </span><span id="local-6989586621679111734"><span class="annot"><a href="#local-6989586621679111734"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679111733"><span class="annot"><a href="#local-6989586621679111733"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Div</span></span><span> </span><span class="annot"><a href="#local-6989586621679111734"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111733"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Mod</span></span><span> </span><span class="annot"><a href="#local-6989586621679111734"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111733"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Type-level equivalent of &lt;https://hackage.haskell.org/package/integer-gmp/docs/GHC-Integer-Logarithms.html#v:integerLogBase-35- integerLogBase#&gt;</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- .i.e. the exact integer equivalent to &quot;@'floor' ('logBase' x y)@&quot;</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-163"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="FLog"><span class="annot"><a href="GHC.TypeLits.Extra.html#FLog"><span class="hs-identifier hs-var">FLog</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111732"><span class="annot"><a href="#local-6989586621679111732"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111731"><span class="annot"><a href="#local-6989586621679111731"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="FLog"><span class="annot"><a href="GHC.TypeLits.Extra.html#FLog"><span class="hs-identifier hs-var">FLog</span></a></span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- Additional equations are provided by the custom solver</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679111729"><span id="local-6989586621679111730"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111730"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111729"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679111730"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679111729"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">FLog</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111730"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111729"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if MIN_VERSION_ghc (8,2,0)
</span><span>  </span><span id="local-6989586621679111727"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.FLog&quot;
</span><a href="#local-6989586621679111727"><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.FLog&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Natural
</span><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-identifier hs-var">intToNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLogBase#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111730"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111729"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">natSing2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SNatKn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">intToNumber</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">integerLogBase#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Type-level equivalent of /the ceiling of/ &lt;https://hackage.haskell.org/package/integer-gmp/docs/GHC-Integer-Logarithms.html#v:integerLogBase-35- integerLogBase#&gt;</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- .i.e. the exact integer equivalent to &quot;@'ceiling' ('logBase' x y)@&quot;</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-178"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="CLog"><span class="annot"><a href="GHC.TypeLits.Extra.html#CLog"><span class="hs-identifier hs-var">CLog</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111726"><span class="annot"><a href="#local-6989586621679111726"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111725"><span class="annot"><a href="#local-6989586621679111725"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>  </span><span id="CLog"><span class="annot"><a href="GHC.TypeLits.Extra.html#CLog"><span class="hs-identifier hs-var">CLog</span></a></span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- Additional equations are provided by the custom solver</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621679111723"><span id="local-6989586621679111724"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111724"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111723"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679111724"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679111723"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">CLog</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111724"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111723"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679111721"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.CLog&quot;
</span><a href="#local-6989586621679111721"><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111720"><span class="annot"><span class="annottext">x :: Integer
</span><a href="#local-6989586621679111720"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111724"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                 </span><span id="local-6989586621679111719"><span class="annot"><span class="annottext">y :: Integer
</span><a href="#local-6989586621679111719"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy y -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111723"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                 </span><span id="local-6989586621679111718"><span class="annot"><span class="annottext">z1 :: Int#
</span><a href="#local-6989586621679111718"><span class="hs-identifier hs-var hs-var">z1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLogBase#</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111720"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111719"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-185"></span><span>                 </span><span id="local-6989586621679111717"><span class="annot"><span class="annottext">z2 :: Int#
</span><a href="#local-6989586621679111717"><span class="hs-identifier hs-var hs-var">z2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLogBase#</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111720"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111719"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>             </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679111719"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>                    </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.CLog&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-188"></span><span>                    </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679111718"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679111717"><span class="hs-identifier hs-var">z2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.CLog&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Natural
</span><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-identifier hs-var">intToNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679111718"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">+#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.CLog&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Natural
</span><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-identifier hs-var">intToNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679111718"><span class="hs-identifier hs-var">z1</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Type-level equivalent of &lt;https://hackage.haskell.org/package/integer-gmp/docs/GHC-Integer-Logarithms.html#v:integerLogBase-35- integerLogBase#&gt;</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- where the operation only reduces when:</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- 'FLog' b x ~ 'CLog' b x</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-197"></span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- Additionally, the following property holds for 'Log':</span><span>
</span><span id="line-199"></span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- &gt; (b ^ (Log b x)) ~ x</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-204"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Log"><span class="annot"><a href="GHC.TypeLits.Extra.html#Log"><span class="hs-identifier hs-var">Log</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111716"><span class="annot"><a href="#local-6989586621679111716"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111715"><span class="annot"><a href="#local-6989586621679111715"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="Log"><span class="annot"><a href="GHC.TypeLits.Extra.html#Log"><span class="hs-identifier hs-var">Log</span></a></span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- Additional equations are provided by the custom solver</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621679111713"><span id="local-6989586621679111714"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111714"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111713"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#FLog"><span class="hs-identifier hs-type">FLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111714"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111713"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="GHC.TypeLits.Extra.html#CLog"><span class="hs-identifier hs-type">CLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111714"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111713"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Log</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111714"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111713"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679111711"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.Log&quot;
</span><a href="#local-6989586621679111711"><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.Log&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Natural
</span><a href="GHC.TypeLits.Extra.html#intToNumber"><span class="hs-identifier hs-var">intToNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLogBase#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111714"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111713"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Type-level greatest common denominator (GCD).</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-214"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="GCD"><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111710"><span class="annot"><a href="#local-6989586621679111710"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111709"><span class="annot"><a href="#local-6989586621679111709"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>  </span><span id="GCD"><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679111708"><span class="annot"><a href="#local-6989586621679111708"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111708"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span id="GCD"><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span id="local-6989586621679111707"><span class="annot"><a href="#local-6989586621679111707"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111707"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span id="GCD"><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679111706"><span class="annot"><a href="#local-6989586621679111706"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-218"></span><span>  </span><span id="GCD"><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span id="local-6989586621679111705"><span class="annot"><a href="#local-6989586621679111705"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-219"></span><span>  </span><span id="GCD"><span class="annot"><a href="GHC.TypeLits.Extra.html#GCD"><span class="hs-identifier hs-var">GCD</span></a></span></span><span> </span><span id="local-6989586621679111704"><span class="annot"><a href="#local-6989586621679111704"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679111704"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111704"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- Additional equations are provided by the custom solver</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span id="local-6989586621679111702"><span id="local-6989586621679111703"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111703"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111702"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">GCD</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111703"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111702"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679111700"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.GCD&quot;
</span><a href="#local-6989586621679111700"><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.GCD&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="hs-cpp">
#if MIN_VERSION_ghc(8,2,0)
</span><span>    </span><span class="annot"><span class="annottext">(Natural -&gt; Natural -&gt; Natural) -&gt; Natural -&gt; Natural -&gt; Natural
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">noinline</span></span><span class="hs-cpp">
#endif
</span><span>      </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">gcd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111703"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111702"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | Type-level least common multiple (LCM).</span><span>
</span><span id="line-230"></span><span class="hs-comment">--</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- Note that additional equations are provided by the type-checker plugin solver</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- &quot;GHC.TypeLits.Extra.Solver&quot;.</span><span>
</span><span id="line-233"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="LCM"><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111698"><span class="annot"><a href="#local-6989586621679111698"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679111697"><span class="annot"><a href="#local-6989586621679111697"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>  </span><span id="LCM"><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679111696"><span class="annot"><a href="#local-6989586621679111696"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-235"></span><span>  </span><span id="LCM"><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span id="local-6989586621679111695"><span class="annot"><a href="#local-6989586621679111695"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-236"></span><span>  </span><span id="LCM"><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679111694"><span class="annot"><a href="#local-6989586621679111694"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111694"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="LCM"><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span id="local-6989586621679111693"><span class="annot"><a href="#local-6989586621679111693"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111693"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="LCM"><span class="annot"><a href="GHC.TypeLits.Extra.html#LCM"><span class="hs-identifier hs-var">LCM</span></a></span></span><span> </span><span id="local-6989586621679111692"><span class="annot"><a href="#local-6989586621679111692"><span class="hs-identifier hs-type hs-type">x</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679111692"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679111692"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-comment">-- Additional equations are provided by the custom solver</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span id="local-6989586621679111690"><span id="local-6989586621679111691"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111691"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679111690"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat2</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">nameToSymbol</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">LCM</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679111691"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679111690"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679111688"><span class="annot"><span class="annottext">natSing2 :: SNatKn &quot;GHC.TypeLits.Extra.LCM&quot;
</span><a href="#local-6989586621679111688"><span class="hs-identifier hs-var hs-var hs-var hs-var">natSing2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; SNatKn &quot;GHC.TypeLits.Extra.LCM&quot;
forall (f :: Symbol). Natural -&gt; SNatKn f
</span><span class="hs-identifier hs-var">SNatKn</span></span><span> </span><span class="hs-special">(</span><span class="hs-cpp">
#if MIN_VERSION_ghc(8,2,0)
</span><span>    </span><span class="annot"><span class="annottext">(Natural -&gt; Natural -&gt; Natural) -&gt; Natural -&gt; Natural -&gt; Natural
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">noinline</span></span><span class="hs-cpp">
#endif
</span><span>      </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">lcm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111691"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y -&gt; Natural
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Natural
</span><span class="hs-identifier hs-var">N.natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy y
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679111690"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-247"></span></pre></body></html>